<!DOCTYPE HTML>
<html>
   <head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>motoGP</title>
        <script src="http://api.conduit.com/BrowserCompApi.js" type="text/javascript"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js" type="text/javascript"></script>
        <script src="http://notifications.conduit-services.com/inject.js" type="text/javascript"></script>

        <script type="text/javascript">
		
		//var NOTIF_MSG_KEY 	= 'motoGP.notif';
		var GK_NAME 		= "GK_motoGP_NOTIF_SENT";

		$(document).ready(init);

		// Include the content of the Init() function in the app's real code.
		// The order of the calls is important!
		function init() {
			var d = new Date();
			ChangeWidth(1);
			//ChangeWidth(150);
			
			   DeleteGlobalKey(GK_NAME);
			  // alert('Global key deleted!');
			
			   var gk = RetrieveGlobalKey(GK_NAME);
			   if (gk == null || gk == '') { // notification not sent yet
				   queueNotification();
		   }
		}
		
		
		function clearGK() {
			DeleteGlobalKey(GK_NAME);
			alert('Global key deleted!');
		}

		function queueNotification() {
			var settings = {
				name : 'motoGP',
				width 	: 302,
				height 	: 252,
				iconUrl : 'http://storage.conduit.com/PS/motoGP/logo.png',
				headerBgColor 	: "#efefef",
				headerTextColor : "#000000",
				iframeUrl: 'http://storage.conduit.com/PS/motoGP/notification.html'

			};
			
			var appInfo = GetInfo(),
			toolbarId = GetToolbarId();
			if (appInfo.appId == '') appInfo.appId = settings.name;
			
			Conduit.Notification({
				id: appInfo.appId,
				toolbarId: toolbarId,
				name: settings.name,
				title: '',
				type:"iframe",
				channel: {
					url: settings.iframeUrl,
					type: 'iframe',
					connectedTrackerDelay: 14400,
					frequency: 8640000
				},
				template: {
					type: 'iframe',
					slideDirection: 'vertical',
					position: 'right bottom',
					width: settings.width,
					height: settings.height + 47,
					bgColor:settings.headerBgColor,
					headerFooterTextColor:settings.headerTextColor,
					iconUrl:settings.iconUrl
				},
				display: {
					autoHide: 300
				},
				analytics: {
					GA_Code: "UA-25806324-1",
					label: "motoGP_Notification",
					value: "Notification"
				},
				"id":0.2030191655578529
			}, settings.name);
			
			// Workaround since the notification system overrides window.EBMessageReceived
			// Handle incoming messages
			var t = window.EBMessageReceived;
			window.EBMessageReceived = function(key, message){
				StoreGlobalKey(GK_NAME, 'sent');
				t(key, message);
			}
		}
		</script>
		<style type="text/css">
		</style>
    </head>
    <body style="padding:0;margin:0; overflow: hidden;">
      
      <!-- <div id="space" style="height: 26px; width: 20px; float: left">W</div>
		<button onclick="clearGK()">Clear Key</button>-->
		
		
    </body>
</html>